---
import Footer from "@components/Footer.astro";
import Header from "@components/Header.astro";
import ClientAfterLoad from "@components/ClientAfterLoad.astro";
import "@fontsource/almarai";

const currentPath = Astro.url.pathname;
const lang = currentPath.startsWith("/en") ? "en" : "ar";
---

<!doctype html>
<html lang={lang} dir={lang === "ar" ? "rtl" : "ltr"}>
	<head>
		<meta charset="UTF-8" />
		<meta name="generator" content="Quronfula" />
		<meta name="google-adsense-account" content="ca-pub-4100521225351324" />

		<link rel="icon" href="/favicon.ico" />
		<link rel="manifest" href="/icons/manifest.json" />
		<meta name="theme-color" content="#ffffff" />

		<style>
			/* ===============================
       FONT FALLBACK
    ================================ */
			@font-face {
				font-family: "Almarai Fallback";
				src: local("Tahoma"), local("Arial");
				ascent-override: 93%;
				descent-override: 24%;
				line-gap-override: 0%;
				size-adjust: 103.5%;
			}

			html {
				font-family:
					system-ui,
					-apple-system,
					sans-serif;
				overflow-x: hidden;
			}

			html[lang="ar"] {
				font-family:
					"Almarai", "Almarai Fallback", system-ui, sans-serif;
			}

			/* ===============================
       THEME VARIABLES
    ================================ */
			:root {
				--bg: #ffffff;
				--text: #0f172a;
				--border: #e5e7eb;
				--ad-bg: #ffffff;
			}

			@media (prefers-color-scheme: dark) {
				:root {
					--bg: #0b0f19;
					--text: #e5e7eb;
					--border: #1f2937;
					--ad-bg: #0f172a;
				}
			}

			/* ===============================
       GLOBAL RESET
    ================================ */
			*,
			*::before,
			*::after {
				box-sizing: border-box;
			}

			html,
			body {
				margin: 0;
				padding: 0;
				width: 100%;
				max-width: 100%;
				overflow-x: hidden;
			}

			body {
				background: var(--bg);
				color: var(--text);
			}

			/* ===============================
       HEADER SAFETY FIX
    ================================ */
			header {
				width: 100%;
				max-width: 100vw;
				overflow-x: hidden;
			}

			/* ===============================
       MAIN GRID LAYOUT
    ================================ */
			main {
				display: grid;
				grid-template-columns: minmax(0, 2fr) minmax(0, 8fr) minmax(
						0,
						2fr
					);
				gap: 16px;

				width: 100%;
				max-width: 100vw;
				margin: 0 auto;
				padding: 16px;

				overflow-x: hidden;
			}

			/* ===============================
       ADS
    ================================ */
			.ad-left,
			.ad-right {
				position: sticky;
				top: 88px;
				height: fit-content;
				max-width: 100%;
			}

			.ad-placeholder {
				width: 100%;
				aspect-ratio: 300 / 600;
				background: var(--ad-bg);
				border: 1px solid var(--border);
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 14px;
				color: #6b7280;
			}

			/* ===============================
       CONTENT
    ================================ */
			.content {
				width: 100%;
				min-width: 0;
			}

			/* ===============================
       MOBILE
    ================================ */
			@media (max-width: 1024px) {
				main {
					grid-template-columns: 1fr;
					padding: 12px;
				}

				.ad-left,
				.ad-right {
					display: none;
				}
			}
		</style>
	</head>

	<body>
		<Header lang={lang} currentPath={Astro.url.pathname} />

		<main>
			<aside class="ad-left">
				<div class="ad-placeholder"></div>
			</aside>

			<section class="content">
				<slot />
			</section>

			<aside class="ad-right">
				<div class="ad-placeholder"></div>
			</aside>
		</main>

		<Footer lang={lang} currentPath={Astro.url.pathname} />
		<ClientAfterLoad />
	</body>
</html>
