---
import Footer from "@components/Footer.astro";
import Header from "@components/Header.astro";
import ClientAfterLoad from "@components/ClientAfterLoad.astro";
import "@fontsource/almarai";
import AdPlaceholder from "@components/AdPlaceholder.astro";
import "../styles/global.css";

const currentPath = Astro.url.pathname;
const lang = currentPath.startsWith("/en") ? "en" : "ar";
const isLocal =
	Astro.url.hostname === "localhost" || Astro.url.hostname === "127.0.0.1";

const organizationSchema = {
	"@context": "https://schema.org",
	"@type": "Organization",
	"@id": "https://www.quronfula.com/#organization",
	name: "Quronfula",
	url: "https://www.quronfula.com",
	logo: {
		"@type": "ImageObject",
		url: "https://www.quronfula.com/logo.webp",
		width: 512,
		height: 512,
	},
};
---

<!doctype html>
<html lang={lang} dir={lang === "ar" ? "rtl" : "ltr"}>
	<head>
		<meta charset="UTF-8" />
		<meta name="generator" content="Quronfula" />
		<meta name="google-adsense-account" content="ca-pub-4100521225351324" />

		<style>
			/* ===============================
       FONT FALLBACK
    ================================ */
			@font-face {
				font-family: "Almarai Fallback";
				src: local("Tahoma"), local("Arial");
				ascent-override: 93%;
				descent-override: 24%;
				line-gap-override: 0%;
				size-adjust: 103.5%;
			}

			html {
				font-family:
					system-ui,
					-apple-system,
					sans-serif;
			}

			html[lang="ar"] {
				font-family:
					"Almarai", "Almarai Fallback", system-ui, sans-serif;
			}

			/* ===============================
       THEME VARIABLES
    ================================ */
			:root {
				--bg: #ffffff;
				--text: #0f172a;
				--border: #e5e7eb;
				--ad-bg: #ffffff;
			}

			@media (prefers-color-scheme: dark) {
				:root {
					--bg: #0b0f19;
					--text: #e5e7eb;
					--border: #1f2937;
					--ad-bg: #0f172a;
				}
			}

			/* ===============================
       GLOBAL RESET
    ================================ */
			*,
			*::before,
			*::after {
				box-sizing: border-box;
			}

			html,
			body {
				margin: 0;
				padding: 0;
				width: 100%;
				max-width: 100%;
			}

			body {
				background: var(--bg);
				color: var(--text);
			}

			/* ===============================
       HEADER SAFETY FIX
    ================================ */
			header {
				width: 100%;
				max-width: 100vw;
				overflow-x: hidden;
			}

			/* ===============================
       MAIN GRID LAYOUT
    ================================ */
			main {
				display: grid;
				grid-template-columns: minmax(0, 2fr) minmax(0, 8fr) minmax(
						0,
						2fr
					);
				gap: 16px;

				width: 100%;
				max-width: 100vw;
				margin: 0 auto;
				padding: 16px;
			}

			/* ===============================
       ADS
    ================================ */
			.ad-left,
			.ad-right {
				position: sticky;
				top: 88px;
				height: fit-content;
				max-width: 100%;
			}

			.ad-placeholder {
				position: sticky;
				top: 0;
				width: 100%;
				aspect-ratio: 300 / 600;
				font-size: 14px;

				background: var(--ad-bg);
				border-bottom: 1px solid var(--border-color);
			}

			/* ===============================
       CONTENT
    ================================ */
			.content {
				width: 100%;
				min-width: 0;
			}

			/* ===============================
       MOBILE
    ================================ */
			@media (max-width: 1024px) {
				main {
					grid-template-columns: 1fr;
					padding: 12px;
				}

				.ad-left,
				.ad-right {
					display: none;
				}
			}
		</style>

		<script type="text/partytown" define:vars={{ gaID: "G-KSSCTHQE28" }}>
			window.dataLayer = window.dataLayer || [];
			window.gtag = function () {
				dataLayer.push(arguments);
			};
			gtag("js", new Date());
			gtag("config", gaID);
		</script>
		{
			!isLocal && (
				<script
					type="text/partytown"
					src="https://www.googletagmanager.com/gtag/js?id=G-KSSCTHQE28"
				/>
			)
		}
		<script
			src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4100521225351324"
		></script>
		<script
			async="async"
			data-cfasync="false"
			src="https://pl28483967.effectivegatecpm.com/7538bd9c37b3bc6235c127a4b18d2e6c/invoke.js"
		></script>
		<script
			type="application/ld+json"
			set:html={JSON.stringify(organizationSchema)}
		/>
	</head>

	<body>
		<Header lang={lang} currentPath={Astro.url.pathname} />

		<main>
			<aside class="ad-left">
				<div class="ad-placeholder">
					<AdPlaceholder
						calledFrom="left_verticle_ads"
						slot="1297307123"
						layout="display"
						format="auto"
						display="block"
						textAlign="center"
						height={600}
						width="100%"
						position="sidebar"
					/>
				</div>
			</aside>

			<section class="content">
				<slot />
			</section>

			<aside class="ad-right">
				<div class="ad-placeholder">
					<AdPlaceholder
						calledFrom="right_verticle_ads"
						slot="3391496735"
						layout="display"
						format="auto"
						display="block"
						textAlign="center"
						height={600}
						width="100%"
						position="sidebar"
					/>
				</div>
			</aside>
		</main>

		<Footer lang={lang} currentPath={Astro.url.pathname} />
		<ClientAfterLoad />
	</body>
</html>
