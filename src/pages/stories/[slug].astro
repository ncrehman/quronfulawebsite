---
import WebStoryAmpRenderer from "@components/commonstories/WebStoryAmpRenderer";
import { getWebStory } from "@components/commonstories/CommonStoriesAmp copy.astro";
import type { WebStoryResponse } from "@lib/pojo/responsemodel/WebStoryResponse";

const { slug } = Astro.params;
const currentPath = Astro.url.pathname;
const lang = currentPath.startsWith("/en") ? "en" : "ar";

if (!slug) {
    return new Response("Not Found", { status: 404 });
}

const story: WebStoryResponse = await getWebStory(lang, slug);
if (!story) {
    return new Response("Story not found", { status: 404 });
}
const response = await WebStoryAmpRenderer({ story, lang });
return response;
---
